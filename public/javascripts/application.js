/* Riot v2.0.15, @license MIT, (c) 2015 Muut Inc. + contributors */
!function(e){function t(e){var t={val:e},n=e.split(/\s+in\s+/);return n[1]&&(t.val=O(0)+n[1],n=n[0].slice(O(0).length).trim().split(/,\s*/),t.key=n[0],t.pos=n[1]),t}function n(e,t,n){var r={};return r[e.key]=t,e.pos&&(r[e.pos]=n),r}function r(e,r,i){function o(e,t,n){d.splice(e,0,t),g.splice(e,0,n)}s(e,"each");var a,f=e.outerHTML,c=e.previousSibling,p=e.parentNode,d=[],g=[];i=t(i),r.one("update",function(){p.removeChild(e)}).one("premount",function(){p.stub&&(p=r.root)}).on("update",function(){var e=A(i.val,r);if(e){if(!Array.isArray(e)){var t=JSON.stringify(e);if(t==a)return;a=t,l(g,function(e){e.unmount()}),d=[],g=[],e=Object.keys(e).map(function(t){return n(i,t,e[t])})}l(d,function(t){if(t instanceof Object){if(e.indexOf(t)>-1)return}else{var n=b(e,t),r=b(d,t);if(n.length>=r.length)return}var i=d.indexOf(t),o=g[i];return o?(o.unmount(),d.splice(i,1),g.splice(i,1),!1):void 0});var s=[].indexOf.call(p.childNodes,c)+1;l(e,function(t,c){var l=e.indexOf(t,c),v=d.indexOf(t,c);if(0>l&&(l=e.lastIndexOf(t,c)),0>v&&(v=d.lastIndexOf(t,c)),!(t instanceof Object)){var m=b(e,t),h=b(d,t);m.length>h.length&&(v=-1)}var y=p.childNodes;if(0>v){if(!a&&i.key)var w=n(i,t,l);var L=new u({tmpl:f},{before:y[s+l],parent:r,root:p,item:w||t});return L.mount(),o(l,t,L),!0}return i.pos&&g[v][i.pos]!=l&&(g[v].one("update",function(e){e[i.pos]=l}),g[v].update()),l!=v?(p.insertBefore(y[s+v],y[s+(l>v?l+1:l)]),o(l,d.splice(v,1)[0],g.splice(v,1)[0])):void 0}),d=e.slice()}})}function i(e,t,n){m(e,function(e){if(1==e.nodeType){e.parentNode&&e.parentNode.isLoop&&(e.isLoop=1),e.getAttribute("each")&&(e.isLoop=1);var r=L(e);if(r&&!e.isLoop){for(var i,o=new u(r,{root:e,parent:t},e.innerHTML),a=r.name,f=t;!L(f.root)&&f.parent;)f=f.parent;o.parent=f,i=f.tags[a],i?(Array.isArray(i)||(f.tags[a]=[i]),f.tags[a].push(o)):f.tags[a]=o,e.innerHTML="",n.push(o)}l(e.attributes,function(n){/^(name|id)$/.test(n.name)&&(t[n.value]=e)})}})}function o(e,t,n){function i(e,t,r){if(t.indexOf(O(0))>=0){var i={dom:e,expr:t};n.push(p(i,r))}}m(e,function(e){var n=e.nodeType;if(3==n&&"STYLE"!=e.parentNode.tagName&&i(e,e.nodeValue),1==n){var o=e.getAttribute("each");return o?(r(e,t,o),!1):(l(e.attributes,function(t){var n=t.name,r=n.split("__")[1];return i(e,t.value,{attr:r||n,bool:r}),r?(s(e,n),!1):void 0}),L(e)?!1:void 0)}})}function u(e,t,n){function r(){l(Object.keys(N),function(e){s[e]=A(N[e],g||f)})}function u(e){if(l(y,function(t){t[e?"mount":"unmount"]()}),g){var t=e?"on":"off";g[t]("update",f.update)[t]("unmount",f.unmount)}}var a,f=C.observable(this),s=w(t.opts)||{},d=v(e.tmpl),g=t.parent,m=[],y=[],b=t.root,L=t.item,x=e.fn,T=b.tagName.toLowerCase(),N={};x&&b._tag&&b._tag.unmount(!0),b._tag=this,this._id=~~((new Date).getTime()*Math.random()),p(this,{parent:g,root:b,opts:s,tags:{}},L),l(b.attributes,function(e){N[e.name]=e.value}),d.innerHTML&&!/select/.test(T)&&(d.innerHTML=h(d.innerHTML,n)),this.update=function(e,t){p(f,e,L),r(),f.trigger("update",L),c(m,f,L),f.trigger("updated")},this.mount=function(){if(r(),x&&x.call(f,s),u(!0),o(d,f,m),f.parent||f.update(),f.trigger("premount"),x)for(;d.firstChild;)b.appendChild(d.firstChild);else a=d.firstChild,b.insertBefore(a,t.before||null);b.stub&&(f.root=b=g.root),f.trigger("mount")},this.unmount=function(e){var t=x?b:a,n=t.parentNode;if(n){if(g)Array.isArray(g.tags[T])?l(g.tags[T],function(e,t){e._id==f._id&&g.tags[T].splice(t,1)}):delete g.tags[T];else for(;t.firstChild;)t.removeChild(t.firstChild);e||n.removeChild(t)}f.trigger("unmount"),u(),f.off("*"),b._tag=null},i(d,this,y)}function a(t,n,r,i,o){r[t]=function(t){t=t||e.event,t.which=t.which||t.charCode||t.keyCode,t.target=t.target||t.srcElement,t.currentTarget=r,t.item=o,n.call(i,t)===!0||/radio|check/.test(r.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1);var u=o?i.parent:i;u.update()}}function f(e,t,n){e&&(e.insertBefore(n,t),e.removeChild(t))}function c(e,t,n){l(e,function(e,r){var i=e.dom,o=e.attr,u=A(e.expr,t),c=e.dom.parentNode;if(null==u&&(u=""),c&&"TEXTAREA"==c.tagName&&(u=u.replace(/riot-/g,"")),e.value!==u){if(e.value=u,!o)return i.nodeValue=u;if(s(i,o),"function"==typeof u)a(o,u,i,t,n);else if("if"==o){var l=e.stub;u?l&&f(l.parentNode,l,i):(l=e.stub=l||document.createTextNode(""),f(i.parentNode,i,l))}else if(/^(show|hide)$/.test(o))"hide"==o&&(u=!u),i.style.display=u?"":"none";else if("value"==o)i.value=u;else if("riot-"==o.slice(0,5))o=o.slice(5),u?i.setAttribute(o,u):s(i,o);else{if(e.bool){if(i[o]=u,!u)return;u=o}"object"!=typeof u&&i.setAttribute(o,u)}}})}function l(e,t){for(var n,r=0,i=(e||[]).length;i>r;r++)n=e[r],null!=n&&t(n,r)===!1&&r--;return e}function s(e,t){e.removeAttribute(t)}function p(e,t,n){return t&&l(Object.keys(t),function(n){e[n]=t[n]}),n?p(e,n):e}function d(){if(e){var t=navigator.userAgent,n=t.indexOf("MSIE ");return n>0?parseInt(t.substring(n+5,t.indexOf(".",n)),10):0}}function g(e,t){var n=document.createElement("option"),r=/value=[\"'](.+?)[\"']/,i=/selected=[\"'](.+?)[\"']/,o=t.match(r),u=t.match(i);n.innerHTML=t,o&&(n.value=o[1]),u&&n.setAttribute("riot-selected",u[1]),e.appendChild(n)}function v(e){var t=e.trim().slice(1,3).toLowerCase(),n=/td|th/.test(t)?"tr":"tr"==t?"tbody":"div",r=document.createElement(n);return r.stub=!0,"op"===t&&N&&10>N?g(r,e):r.innerHTML=e,r}function m(e,t){if(e)if(t(e)===!1)m(e.nextSibling,t);else for(e=e.firstChild;e;)m(e,t),e=e.nextSibling}function h(e,t){return e.replace(/<(yield)\/?>(<\/\1>)?/gim,t||"")}function y(e,t){return t=t||document,t.querySelectorAll(e)}function b(e,t){return e.filter(function(e){return e===t})}function w(e){function t(){}return t.prototype=e,new t}function L(e){return _[e.getAttribute("riot-tag")||e.tagName.toLowerCase()]}function x(e){var t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)}function T(e,t,n){var r=_[t],i=e.innerHTML;return e.innerHTML="",r&&e&&(r=new u(r,{root:e,opts:n},i)),r&&r.mount?(r.mount(),E.push(r),r.on("unmount",function(){E.splice(E.indexOf(r),1)})):void 0}var C={version:"v2.0.15",settings:{}},N=d();C.observable=function(e){e=e||{};var t={},n=0;return e.on=function(r,i){return"function"==typeof i&&(i._id="undefined"==typeof i._id?n++:i._id,r.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(i),i.typed=n>0})),e},e.off=function(n,r){return"*"==n?t={}:n.replace(/\S+/g,function(e){if(r)for(var n,i=t[e],o=0;n=i&&i[o];++o)n._id==r._id&&(i.splice(o,1),o--);else t[e]=[]}),e},e.one=function(t,n){function r(){e.off(t,r),n.apply(e,arguments)}return e.on(t,r)},e.trigger=function(n){for(var r,i=[].slice.call(arguments,1),o=t[n]||[],u=0;r=o[u];++u)r.busy||(r.busy=1,r.apply(e,r.typed?[n].concat(i):i),o[u]!==r&&u--,r.busy=0);return t.all&&"all"!=n&&e.trigger.apply(e,["all",n].concat(i)),e},e},function(e,t,n){function r(){return a.href.split("#")[1]||""}function i(e){return e.split("/")}function o(e){e.type&&(e=r()),e!=u&&(f.trigger.apply(null,["H"].concat(i(e))),u=e)}if(n){var u,a=n.location,f=e.observable(),c=n,l=!1,s=e.route=function(e){e[0]?(a.hash=e,o(e)):f.on("H",e)};s.exec=function(e){e.apply(null,i(r()))},s.parser=function(e){i=e},s.stop=function(){l&&(c.removeEventListener?c.removeEventListener(t,o,!1):c.detachEvent("on"+t,o),f.off("*"),l=!1)},s.start=function(){l||(c.addEventListener?c.addEventListener(t,o,!1):c.attachEvent("on"+t,o),l=!0)},s.start()}}(C,"hashchange",e);var O=function(e,t,n){return function(r){return t=C.settings.brackets||e,n!=t&&(n=t.split(" ")),r&&r.test?t==e?r:RegExp(r.source.replace(/\{/g,n[0].replace(/(?=.)/g,"\\")).replace(/\}/g,n[1].replace(/(?=.)/g,"\\")),r.global?"g":""):n[r]}}("{ }"),A=function(){function t(e,t){return e=(e||O(0)+O(1)).replace(O(/\\{/g),"￰").replace(O(/\\}/g),"￱"),t=i(e,o(e,O(/{/),O(/}/))),new Function("d","return "+(t[0]||t[2]||t[3]?"["+t.map(function(e,t){return t%2?n(e,!0):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':n(t[1])).replace(/\uFFF0/g,O(0)).replace(/\uFFF1/g,O(1))+";")}function n(e,t){return e=e.replace(/\n/g," ").replace(O(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(e)?"["+o(e,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(e){return e.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(e,t,n){return n.replace(/[^&|=!><]+/g,r)+'?"'+t+'":"",'})}).join("")+'].join(" ").trim()':r(e,t)}function r(t,n){return t=t.trim(),t?"(function(v){try{v="+(t.replace(a,function(t,n,r){return r?"(d."+r+"===undefined?"+("undefined"==typeof e?"global.":"window.")+r+":d."+r+")":t})||"x")+"}finally{return "+(n===!0?'!v&&v!==0?"":v':"v")+"}}).call(d)":""}function i(e,t){var n=[];return t.map(function(t,r){r=e.indexOf(t),n.push(e.slice(0,r),t),e=e.slice(r+t.length)}),n.concat(e)}function o(e,t,n){var r,i=0,o=[],u=new RegExp("("+t.source+")|("+n.source+")","g");return e.replace(u,function(t,n,u,a){!i&&n&&(r=a),i+=n?1:-1,i||null==u||o.push(e.slice(r,a+u.length))}),o}var u={},a=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_$]\w*)/gi;return function(e,n){return e&&(u[e]=u[e]||t(e))(n)}}(),E=[],_={};C.tag=function(e,t,n,r){return"function"==typeof n?r=n:n&&x(n),_[e]={name:e,tmpl:t,fn:r},e},C.mount=function(e,t,n){function r(e){var r=t||e.getAttribute("riot-tag")||e.tagName.toLowerCase(),i=T(e,r,n);i&&u.push(i)}var i,o=function(e){return e=Object.keys(_).join(", "),e.split(",").map(function(t){e+=', *[riot-tag="'+t.trim()+'"]'}),e},u=[];if("object"==typeof t&&(n=t,t=0),"string"==typeof e?("*"==e&&(e=o(e)),i=y(e)):i=e,"*"==t){if(t=o(e),i.tagName)i=y(t,i);else{var a=[];l(i,function(e){a=y(t,e)}),i=a}t=0}return i.tagName?r(e):l(i,r),u},C.update=function(){return l(E,function(e){e.update()})},C.mountTo=C.mount,C.util={brackets:O,tmpl:A},"object"==typeof exports?module.exports=C:"function"==typeof define&&define.amd?define(function(){return C}):e.riot=C}("undefined"!=typeof window?window:void 0);